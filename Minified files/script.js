var database,primaryColor="#3949ab",secondaryColor="rgba(57, 73, 172, 0.15)",data=[[],[],[],[],[],[]],labels=[[],[],[],[],[],[]],getcharts=[],charts=[],days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],table=document.getElementById("table");getcharts[0]=document.getElementById("myChart1").getContext("2d"),getcharts[1]=document.getElementById("myChart2").getContext("2d"),getcharts[2]=document.getElementById("myChart3").getContext("2d"),getcharts[3]=document.getElementById("myChart4").getContext("2d"),getcharts[4]=document.getElementById("myChart5").getContext("2d"),getcharts[5]=document.getElementById("myChart6").getContext("2d");var oReq=new XMLHttpRequest;for(oReq.open("get","db.php",!0),oReq.send(),oReq.onreadystatechange=function(){if(4===oReq.readyState){for(SimplifyData(database=JSON.parse(this.responseText)),document.getElementById("mainImage").src=LoadImage(),document.getElementById("currentTemp").innerHTML="Current temperature is "+data[0][23]+"°C",document.getElementById("currentHum").innerHTML="Current humidity is "+data[1][23]+"RH",i=0;i<6;i++)AddData(charts[i],labels[i],data[i]);CreateTable(table),oReq.abort()}},document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".sidenav");M.Sidenav.init(e,{inDuration:350,outDuration:350,edge:"right",draggable:!0})}),i=0;i<6;i++)charts[i]=new Chart(getcharts[i],{type:"line",data:{datasets:[{label:"Temperature",backgroundColor:secondaryColor,borderColor:primaryColor}]},options:{responsive:!0,tooltips:{callbacks:{label:e=>`${e.yLabel} °C`}},scales:{yAxes:[{ticks:{callback:function(e,t,a){return e+"°C"}}}]}}});for(i=0;i<6;i++)1!=i&&3!=i&&5!=i||(charts[i].data.datasets[0].label="Humidity",charts[i].options.tooltips.callbacks.label=(e=>`${e.yLabel} RH`),charts[i].options.scales.yAxes[0].ticks.callback=function(e,t,a){return e+" RH"},charts[i].update());var scroll=new SmoothScroll('a[href*="#"]',{header:"nav",speed:500,speedAsDuration:!0,easing:"easeInOutCubic",offset:function(e,t){return 10}});function CreateTable(e){for(i=0;i<database[0].length;i++)for(e.insertRow(-1),j=0;j<3;j++)e.rows[i+1].insertCell(j).innerHTML=database[0][i][j]}function GetDayOfWeek(e){return new Intl.DateTimeFormat("en-US",{weekday:"short"}).format(e)}function GetNumberWithOrdinal(e){var t=["th","st","nd","rd"],a=e%100;return e+(t[(a-20)%10]||t[a]||t[0])}function SimplifyData(e){for(i=0;i<e[0].length;i++)labels[0][23-i]=new Date(e[0][i][0]).getHours()+":00",data[0][23-i]=e[0][i][1],labels[1]=labels[0],data[1][23-i]=e[0][i][2];for(i=0;i<e[1].length;i++)labels[2][41-i]=GetDayOfWeek(new Date(e[1][i][0])),data[2][41-i]=e[1][i][1],labels[3]=labels[2],data[3][41-i]=e[1][i][2];for(i=0;i<e[2].length;i++)labels[4][30-i]=GetNumberWithOrdinal(new Date(e[2][i][0]).getDate()),data[4][30-i]=e[2][i][1],labels[5]=labels[4],data[5][30-i]=e[2][i][2]}function AddData(e,t,a){e.data.labels=t,e.data.datasets.forEach(e=>{e.data=a}),e.update()}function LoadImage(){return day=[6,7,8,9,10,11,12,13,14,15,16,17,18],src="/weather_icons/unknown.png",temp=data[0][23],hum=data[1][23],day.includes(new Date(database[0][0][0]).getHours())?temp<=0&&hum<=50?src="/weather_icons/snow-day.png":temp<=0&&hum>50?src="/weather_icons/rain-snow-day.png":temp<=15&&hum<=50?src="/weather_icons/mostly-cloudy.png":temp<=15&&hum>50?src="/weather_icons/rainy-day.png":temp<=50&&hum<=50?src="/weather_icons/clear-day.png":temp<=50&&hum>50&&(src="/weather_icons/thunder-day.png"):temp<=0&&hum<=50?src="/weather_icons/snow-night.png":temp<=0&&hum>50?src="/weather_icons/rain-snow-night.png":temp<=15&&hum<=50?src="/weather_icons/mostly-cloudy-night.png":temp<=15&&hum>50?src="/weather_icons/rainy-night.png":temp<=50&&hum<=50?src="/weather_icons/clear-night.png":temp<=50&&hum>50&&(src="/weather_icons/thunder-night.png"),src}